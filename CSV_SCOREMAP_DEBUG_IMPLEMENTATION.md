# ã€CSVâ†’scoreMap DEBUGã€‘å®Ÿè£…å®Œäº†

## ðŸŽ¯ ç›®çš„

CSVèª­ã¿è¾¼ã¿å‡¦ç†ã§ã€`scoreMap.set()`ã™ã‚‹ç›´å‰ã«å¯¾è±¡ã‚­ãƒ¼å°‚ç”¨ãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã€
`scoreRaw`ãŒ"5"ã€`final score`ãŒ5ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

---

## âœ… å®Ÿè£…å†…å®¹

### 1. scoreMap.setç›´å‰ã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°

```javascript
// ===== ã€CSVâ†’scoreMap DEBUGã€‘å¯¾è±¡ã‚­ãƒ¼å°‚ç”¨ãƒ­ã‚°ï¼ˆscoreMap.setç›´å‰ï¼‰ =====
if (categoryTrim === "è·æ¥­ç”Ÿæ´»" && itemTrim === "æ¬ å¸­ç­‰ã®é€£çµ¡") {
    console.log("\n=== CSV->scoreMap DEBUG START ===");
    console.log("lineNo:", rowIndex + 2);
    console.log("raw line (split result):", row);
    console.log("columns:");
    console.log("  ã‚«ãƒ†ã‚´ãƒª:", JSON.stringify(categoryRaw));
    console.log("  é …ç›®:", JSON.stringify(itemNameRaw));
    console.log("  ã‚¹ã‚³ã‚¢åˆ—index:", colMap['ã‚¹ã‚³ã‚¢']);
    console.log("  è©•ä¾¡åˆ—index:", colMap['è©•ä¾¡']);
    console.log("scoreRaw:", scoreRaw, "json:", JSON.stringify(scoreRaw));
    console.log("scoreRaw source: row[" + colMap['ã‚¹ã‚³ã‚¢'] + "]");
    console.log("è©•ä¾¡åˆ—ã®å€¤:", hyokaText, "json:", JSON.stringify(hyokaText), "â† ã‚¹ã‚³ã‚¢è¨ˆç®—ã«ã¯ä½¿ç”¨ã—ãªã„");
    console.log("scoreç®—å‡ºéŽç¨‹:");
    console.log("  1. trim:", JSON.stringify(scoreTrimmed));
    console.log("  2. Number():", scoreNumber);
    console.log("  3. ç¯„å›²ãƒã‚§ãƒƒã‚¯(1ã€œ5):", score);
    console.log("final score:", score, "type:", typeof score);
    console.log("key:", JSON.stringify(key));
    console.log("=== CSV->scoreMap DEBUG END ===");
}

// â†“ ã“ã®ç›´å¾Œã« scoreMap.set(key, score);
```

### 2. ã‚¹ã‚³ã‚¢ç®—å‡ºã‚’çµ±ä¸€

```javascript
// ===== ã€é‡è¦ã€‘ã‚¹ã‚³ã‚¢ç®—å‡º: ã€Œã‚¹ã‚³ã‚¢ã€åˆ—ã®ã¿ä½¿ç”¨ =====
// 1. trim()ã§å‰å¾Œã®ç©ºç™½é™¤åŽ»
// 2. Number()ã§æ•°å€¤åŒ–
// 3. 1ã€œ5ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼ˆç¯„å›²å¤–ã¯nullï¼‰
const scoreTrimmed = String(scoreRaw || '').trim();
const scoreNumber = Number(scoreTrimmed);
const score = (!isNaN(scoreNumber) && scoreNumber >= 1 && scoreNumber <= 5) 
    ? scoreNumber 
    : null;
```

**è¦ä»¶éµå®ˆ**:
- âœ… scoreRawã¯å¿…ãšã€Œã‚¹ã‚³ã‚¢ã€åˆ—ã‹ã‚‰å–ã‚‹ï¼ˆ`row[colMap['ã‚¹ã‚³ã‚¢']]`ï¼‰
- âœ… score = Number(scoreRaw.trim())
- âœ… 1ã€œ5ä»¥å¤–ã¯null
- âœ… è©•ä¾¡åˆ—ã¯çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„

---

## ðŸ” æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›

### CSVå†…å®¹ï¼ˆä¾‹ï¼‰

```csv
è¨˜å…¥æ—¥,åˆ©ç”¨è€…å,ç®¡ç†ç•ªå·,è©•ä¾¡å®Ÿæ–½è€…å,è©•ä¾¡æœŸé–“é–‹å§‹,è©•ä¾¡æœŸé–“çµ‚äº†,ã‚«ãƒ†ã‚´ãƒª,é …ç›®,ã‚¹ã‚³ã‚¢,è©•ä¾¡,ãƒ¡ãƒ¢
2026-02-18,ãƒ†ã‚¹ãƒˆå¤ªéƒŽ,TEST001,å±±ç”°èŠ±å­,2026-02-01,2026-02-15,è·æ¥­ç”Ÿæ´»,æ¬ å¸­ç­‰ã®é€£çµ¡,5,ã§ãã‚‹,æ­£å¸¸ã«é€£çµ¡ã§ãã‚‹
```

### ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›

```
ðŸ“Š CSVãƒ˜ãƒƒãƒ€ãƒ¼è§£æž:
  header: ["è¨˜å…¥æ—¥", "åˆ©ç”¨è€…å", ..., "ã‚¹ã‚³ã‚¢", "è©•ä¾¡", "ãƒ¡ãƒ¢"]
  header.length: 11
  colMap: {è¨˜å…¥æ—¥: 0, åˆ©ç”¨è€…å: 1, ..., ã‚¹ã‚³ã‚¢: 8, è©•ä¾¡: 9, ãƒ¡ãƒ¢: 10}
  ãƒ‡ãƒ¼ã‚¿è¡Œæ•°: 22

=== CSV->scoreMap DEBUG START ===
lineNo: 15
raw line (split result): ["2026-02-18", "ãƒ†ã‚¹ãƒˆå¤ªéƒŽ", "TEST001", "å±±ç”°èŠ±å­", "2026-02-01", "2026-02-15", "è·æ¥­ç”Ÿæ´»", "æ¬ å¸­ç­‰ã®é€£çµ¡", "5", "ã§ãã‚‹", "æ­£å¸¸ã«é€£çµ¡ã§ãã‚‹"]
columns:
  ã‚«ãƒ†ã‚´ãƒª: "è·æ¥­ç”Ÿæ´»"
  é …ç›®: "æ¬ å¸­ç­‰ã®é€£çµ¡"
  ã‚¹ã‚³ã‚¢åˆ—index: 8
  è©•ä¾¡åˆ—index: 9
scoreRaw: 5 json: "5"
scoreRaw source: row[8]
è©•ä¾¡åˆ—ã®å€¤: ã§ãã‚‹ json: "ã§ãã‚‹" â† ã‚¹ã‚³ã‚¢è¨ˆç®—ã«ã¯ä½¿ç”¨ã—ãªã„
scoreç®—å‡ºéŽç¨‹:
  1. trim: "5"
  2. Number(): 5
  3. ç¯„å›²ãƒã‚§ãƒƒã‚¯(1ã€œ5): 5
final score: 5 type: number
key: "è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"
=== CSV->scoreMap DEBUG END ===

ðŸ”ðŸ”ðŸ” [ç‰¹å®šã‚­ãƒ¼è¿½è·¡é–‹å§‹] ðŸ”ðŸ”ðŸ”
âœ… scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5 (type: number)
ðŸŽ‰ðŸŽ‰ðŸŽ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢ï¼šã‚¹ã‚³ã‚¢ãŒ5ã§ã™ï¼ ðŸŽ‰ðŸŽ‰ðŸŽ‰
```

---

## ðŸ“‹ é”æˆæ¡ä»¶

### âœ… æ¡ä»¶1: scoreRawãŒ"5"ã¨å‡ºã‚‹

```
scoreRaw: 5 json: "5"
```

### âœ… æ¡ä»¶2: final scoreãŒ5

```
final score: 5 type: number
```

### âœ… æ¡ä»¶3: scoreMap.get()ãŒ5

```
scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
ðŸŽ‰ðŸŽ‰ðŸŽ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢ï¼šã‚¹ã‚³ã‚¢ãŒ5ã§ã™ï¼ ðŸŽ‰ðŸŽ‰ðŸŽ‰
```

---

## ðŸ› å•é¡Œã®ç‰¹å®šæ–¹æ³•

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: scoreRawãŒ"4"ï¼ˆCSVãƒ•ã‚¡ã‚¤ãƒ«å†…ãŒ4ï¼‰

```
scoreRaw: 4 json: "4"
final score: 4 type: number
```

**åŽŸå› **: CSVãƒ•ã‚¡ã‚¤ãƒ«ã®è©²å½“ã‚»ãƒ«ãŒå®Ÿéš›ã«4ã§ã‚ã‚‹

**å¯¾å‡¦**: CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã¦5ã«ã™ã‚‹

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: scoreRawãŒ"ã§ãã‚‹"ï¼ˆã‚«ãƒ©ãƒ ãšã‚Œï¼‰

```
scoreRaw: ã§ãã‚‹ json: "ã§ãã‚‹"
scoreRaw source: row[8]
è©•ä¾¡åˆ—ã®å€¤: 5 json: "5"
final score: null type: object
```

**åŽŸå› **: ã‚¹ã‚³ã‚¢åˆ—ã¨è©•ä¾¡åˆ—ãŒå…¥ã‚Œæ›¿ã‚ã£ã¦ã„ã‚‹

**å¯¾å‡¦**: 
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼é †åºã‚’ç¢ºèª
- colMap['ã‚¹ã‚³ã‚¢']ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¢ºèª
- CSVã®æ§‹é€ ã‚’ç¢ºèª

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: scoreRawãŒç©ºï¼ˆãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰

```
scoreRaw:  json: ""
final score: null type: object
```

**åŽŸå› **: CSVã®è©²å½“ã‚»ãƒ«ãŒç©º

**å¯¾å‡¦**: CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¹ã‚³ã‚¢ã‚’å…¥åŠ›ã™ã‚‹

### ãƒ‘ã‚¿ãƒ¼ãƒ³4: rowé…åˆ—ã®é•·ã•ãŒä¸ä¸€è‡´

```
raw line (split result): ["2026-02-18", "ãƒ†ã‚¹ãƒˆå¤ªéƒŽ", ..., "5"]  â† 10è¦ç´ ã—ã‹ãªã„
colMap['ã‚¹ã‚³ã‚¢'] index: 8
colMap['è©•ä¾¡'] index: 9  â† å­˜åœ¨ã—ãªã„
```

**åŽŸå› **: CSVè¡Œã®ã‚«ãƒ©ãƒ æ•°ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã‚ˆã‚Šå°‘ãªã„

**å¯¾å‡¦**: CSVãƒ•ã‚¡ã‚¤ãƒ«ã®è©²å½“è¡Œã‚’ä¿®æ­£

---

## ðŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### æ‰‹é †

1. https://smilestep-code.github.io/assessment-app/
2. **Ctrl+Shift+R** ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
3. **F12** â†’ Console ã‚¿ãƒ–
4. CSVèª­è¾¼ï¼ˆã€Œè·æ¥­ç”Ÿæ´»ã€ã€Œæ¬ å¸­ç­‰ã®é€£çµ¡ã€ã‚¹ã‚³ã‚¢5ã‚’å«ã‚€ï¼‰
5. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ç¢ºèª

### ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

#### ã‚¹ãƒ†ãƒƒãƒ—1: CSVãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª

```
colMap['ã‚¹ã‚³ã‚¢']: 8  â† æ­£ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ï¼Ÿ
colMap['è©•ä¾¡']: 9    â† æ­£ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ï¼Ÿ
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: CSVâ†’scoreMap DEBUG

```
scoreRaw: 5 json: "5"              â† "5"ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
scoreRaw source: row[8]            â† rowé…åˆ—ã®8ç•ªç›®ã‹ã‚‰å–å¾—
è©•ä¾¡åˆ—ã®å€¤: ã§ãã‚‹ json: "ã§ãã‚‹"    â† è©•ä¾¡åˆ—ã¯ä½¿ç”¨ã—ãªã„
final score: 5 type: number        â† 5ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: scoreMapæœ€çµ‚ç¢ºèª

```
scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
ðŸŽ‰ðŸŽ‰ðŸŽ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢
```

---

## ðŸ“Š ãƒ­ã‚°ã®èª­ã¿æ–¹

### rowé…åˆ—ã®æ§‹é€ 

```javascript
row = [
  "2026-02-18",     // 0: è¨˜å…¥æ—¥
  "ãƒ†ã‚¹ãƒˆå¤ªéƒŽ",      // 1: åˆ©ç”¨è€…å
  "TEST001",        // 2: ç®¡ç†ç•ªå·
  "å±±ç”°èŠ±å­",       // 3: è©•ä¾¡å®Ÿæ–½è€…å
  "2026-02-01",     // 4: è©•ä¾¡æœŸé–“é–‹å§‹
  "2026-02-15",     // 5: è©•ä¾¡æœŸé–“çµ‚äº†
  "è·æ¥­ç”Ÿæ´»",       // 6: ã‚«ãƒ†ã‚´ãƒª
  "æ¬ å¸­ç­‰ã®é€£çµ¡",   // 7: é …ç›®
  "5",              // 8: ã‚¹ã‚³ã‚¢ â† colMap['ã‚¹ã‚³ã‚¢'] = 8
  "ã§ãã‚‹",         // 9: è©•ä¾¡ â† colMap['è©•ä¾¡'] = 9
  "æ­£å¸¸ã«é€£çµ¡ã§ãã‚‹" // 10: ãƒ¡ãƒ¢
]
```

### scoreRawå–å¾—æ–¹æ³•

```javascript
const scoreRaw = row[colMap['ã‚¹ã‚³ã‚¢']];
// = row[8]
// = "5"
```

### ã‚¹ã‚³ã‚¢ç®—å‡ºéŽç¨‹

```javascript
const scoreTrimmed = String(scoreRaw || '').trim();  // "5"
const scoreNumber = Number(scoreTrimmed);            // 5
const score = (scoreNumber >= 1 && scoreNumber <= 5) ? scoreNumber : null;  // 5
```

---

## ðŸ“ å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

1. **js/assessment.js**
   - CSVâ†’scoreMap DEBUGãƒ­ã‚°ã‚’`scoreMap.set`ç›´å‰ã«è¿½åŠ 
   - ã‚¹ã‚³ã‚¢ç®—å‡ºã‚’`Number(scoreRaw.trim())`ã«çµ±ä¸€
   - è©•ä¾¡åˆ—ã‚’å®Œå…¨ã«é™¤å¤–

2. **index.html**
   - ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°: `?v=202602180130` â†’ `?v=202602180140`

---

## ðŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±

- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 202602180140
- **å¤‰æ›´å†…å®¹**: CSVâ†’scoreMap DEBUGãƒ­ã‚°è¿½åŠ 
- **ã‚³ãƒŸãƒƒãƒˆ**: ï¼ˆæ¬¡ã®ã‚³ãƒŸãƒƒãƒˆã§ç¢ºå®šï¼‰
- **GitHub Pages**: https://smilestep-code.github.io/assessment-app/

---

## ðŸ’¡ é‡è¦ãƒã‚¤ãƒ³ãƒˆ

### 1. ãƒ­ã‚°ã®é †åº

```
1. CSVãƒ˜ãƒƒãƒ€ãƒ¼è§£æž
2. CSVâ†’scoreMap DEBUGï¼ˆå¯¾è±¡è¡Œã®ã¿ï¼‰â† â˜…ã“ã“ãŒé‡è¦
3. scoreMapç¢ºèª
4. items.jsonåŸ‹ã‚æˆ»ã—
```

### 2. scoreRawå–å¾—å…ƒ

```
scoreRaw = row[colMap['ã‚¹ã‚³ã‚¢']]
         = row[8]
         = CSVã®9åˆ—ç›®ï¼ˆ0-indexãªã®ã§8ï¼‰
```

### 3. è©•ä¾¡åˆ—ã¯çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„

```
è©•ä¾¡åˆ—ã®å€¤: ã§ãã‚‹ â† ã‚¹ã‚³ã‚¢è¨ˆç®—ã«ã¯ä½¿ç”¨ã—ãªã„
```

---

**ä½œæˆæ—¥**: 2026-02-18  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 202602180140  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»ãƒ†ã‚¹ãƒˆå¾…ã¡

---

**é‡è¦**: å¿…ãš **Ctrl+Shift+R** ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰ç¢ºèªã—ã¦ãã ã•ã„ï¼

`scoreRaw`ã®å€¤ãŒå•é¡Œã®æ ¸å¿ƒã§ã™ã€‚ã“ã®å€¤ãŒ"5"ã§ãªã„å ´åˆã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ã‚«ãƒ©ãƒ ãƒžãƒƒãƒ”ãƒ³ã‚°ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚
