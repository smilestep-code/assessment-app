# ã€scoreMap.set ãƒ•ãƒƒã‚¯ã€‘å®Ÿè£…å®Œäº†

## ğŸ¯ ç›®çš„

`scoreMap.set()`ã‚’ãƒ•ãƒƒã‚¯ã—ã¦ã€"è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"ãŒè¨­å®šã•ã‚Œã‚‹ç¬é–“ã‚’100%æ•æ‰ã—ã€
å€¤ãŒ5ãªã®ã‹4ãªã®ã‹ã€ã©ã“ã‹ã‚‰å‘¼ã³å‡ºã•ã‚ŒãŸã‹ã‚’ç¢ºèªã™ã‚‹ã€‚

---

## âœ… å®Ÿè£…å†…å®¹

### scoreMap.setã®ãƒ•ãƒƒã‚¯ï¼ˆCSVèª­ã¿è¾¼ã¿å‡¦ç†ã®å†’é ­ï¼‰

```javascript
// ===== ã€é‡è¦ã€‘ã‚«ãƒ†ã‚´ãƒª+é …ç›®åã§Mapã‚’ä½œæˆï¼ˆindexé †ã«ä¾å­˜ã—ãªã„ï¼‰ =====
const scoreMap = new Map();
const memoMap = new Map();

// ===== ã€ãƒ‡ãƒãƒƒã‚°ã€‘scoreMap.setã‚’ãƒ•ãƒƒã‚¯ã—ã¦å€¤ã®è¨­å®šã‚’100%æ•æ‰ =====
const originalSet = scoreMap.set.bind(scoreMap);
scoreMap.set = (k, v) => {
    if (k === "è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") {
        console.log("\n=== scoreMap.set TRACE START ===");
        console.log("key:", JSON.stringify(k));
        console.log("value:", v, "type:", typeof v);
        console.trace("STACK TRACE");
        console.log("=== scoreMap.set TRACE END ===");
    }
    return originalSet(k, v);
};
```

**ä»•çµ„ã¿**:
1. `scoreMap`ä½œæˆç›´å¾Œã«ã€å…ƒã®`set`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿å­˜
2. `scoreMap.set`ã‚’ç‹¬è‡ªé–¢æ•°ã§ä¸Šæ›¸ã
3. ã‚­ãƒ¼ãŒ"è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"ã®å ´åˆã€å€¤ã¨ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ãƒ­ã‚°å‡ºåŠ›
4. å…ƒã®`set`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã€å®Ÿéš›ã«Mapã«å€¤ã‚’è¨­å®š

---

## ğŸ” æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›

### ã‚±ãƒ¼ã‚¹1: æ­£å¸¸ï¼ˆå€¤ãŒ5ï¼‰

```
ğŸ“Š CSVãƒ˜ãƒƒãƒ€ãƒ¼è§£æ:
  colMap: {ã‚¹ã‚³ã‚¢: 8, è©•ä¾¡: 9, ...}

=== CSV->scoreMap DEBUG START ===
scoreRaw: 5 json: "5"
final score: 5 type: number
=== CSV->scoreMap DEBUG END ===

=== scoreMap.set TRACE START ===
key: "è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"
value: 5 type: number
STACK TRACE
    at scoreMap.set (assessment.js:890)
    at assessment.js:945
    at Array.forEach (<anonymous>)
    at FileReader.reader.onload (assessment.js:892)
=== scoreMap.set TRACE END ===

âœ… scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
ğŸ‰ğŸ‰ğŸ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢ï¼šã‚¹ã‚³ã‚¢ãŒ5ã§ã™ï¼ ğŸ‰ğŸ‰ğŸ‰
```

### ã‚±ãƒ¼ã‚¹2: ç•°å¸¸ï¼ˆå€¤ãŒ4ï¼‰

```
=== scoreMap.set TRACE START ===
key: "è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"
value: 4 type: number
STACK TRACE
    at scoreMap.set (assessment.js:890)
    at assessment.js:945  â† ã“ã“ãŒå‘¼ã³å‡ºã—å…ƒ
    at Array.forEach (<anonymous>)
    at FileReader.reader.onload (assessment.js:892)
=== scoreMap.set TRACE END ===

âŒ scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 4ï¼ˆæœŸå¾…å€¤: 5ï¼‰
```

**å¯¾å‡¦**:
- ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®è¡Œç•ªå·ï¼ˆä¾‹: assessment.js:945ï¼‰ã‚’ç¢ºèª
- ãã®è¡Œã®ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¢ºèª
- `row[colMap['ã‚¹ã‚³ã‚¢']]`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- è©•ä¾¡åˆ—ã‹ã‚‰å¤‰æ›ã—ã¦ã„ãªã„ã‹ç¢ºèª

---

## ğŸ“‹ é”æˆæ¡ä»¶

### âœ… æ¡ä»¶1: scoreMap.set TRACEãŒè¡¨ç¤ºã•ã‚Œã‚‹

```
=== scoreMap.set TRACE START ===
...
=== scoreMap.set TRACE END ===
```

### âœ… æ¡ä»¶2: valueãŒ5

```
value: 5 type: number
```

### âœ… æ¡ä»¶3: scoreMap.get()ãŒ5

```
scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
ğŸ‰ğŸ‰ğŸ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: TRACEãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ã‚­ãƒ¼ãŒ"è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡"ã¨å®Œå…¨ä¸€è‡´ã—ã¦ã„ãªã„

**ç¢ºèªæ–¹æ³•**:
```javascript
// ã™ã¹ã¦ã®ã‚­ãƒ¼ã‚’å‡ºåŠ›
scoreMap.forEach((v, k) => {
    if (k.includes('è·æ¥­ç”Ÿæ´»') && k.includes('æ¬ å¸­')) {
        console.log('ã‚­ãƒ¼:', JSON.stringify(k));
    }
});
```

**å¯¾å‡¦**: ã‚­ãƒ¼ã®æ­£è¦åŒ–å‡¦ç†ã‚’ç¢ºèª

### å•é¡Œ2: valueãŒ4

**åŸå› **: ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ãŒé–“é•ã£ã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•**:
1. ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®è¡Œç•ªå·ã‚’ç¢ºèª
2. ãã®è¡Œã®`scoreRaw`ã®å–å¾—å…ƒã‚’ç¢ºèª
3. `row[colMap['ã‚¹ã‚³ã‚¢']]`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª

**å¯¾å‡¦**:
```javascript
// æ­£ã—ã„å®Ÿè£…
const scoreRaw = row[colMap['ã‚¹ã‚³ã‚¢']];  // â† å¿…ãšã€Œã‚¹ã‚³ã‚¢ã€åˆ—
const scoreTrimmed = String(scoreRaw || '').trim();
const scoreNumber = Number(scoreTrimmed);
const score = (!isNaN(scoreNumber) && scoreNumber >= 1 && scoreNumber <= 5) 
    ? scoreNumber 
    : null;
```

### å•é¡Œ3: valueãŒnull

**åŸå› **: ã‚¹ã‚³ã‚¢ã®å¤‰æ›ã«å¤±æ•—ã—ã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•**:
- `scoreRaw`ã®å€¤ã‚’ç¢ºèª
- `Number(scoreRaw.trim())`ã®çµæœã‚’ç¢ºèª
- 1ã€œ5ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯ãŒæ­£ã—ã„ã‹ç¢ºèª

**å¯¾å‡¦**:
```javascript
// ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ 
console.log('scoreRaw:', JSON.stringify(scoreRaw));
console.log('trimmed:', JSON.stringify(scoreRaw.trim()));
console.log('Number():', Number(scoreRaw.trim()));
```

### å•é¡Œ4: TRACEãŒè¤‡æ•°å›å‡ºã‚‹

**åŸå› **: åŒã˜ã‚­ãƒ¼ã§è¤‡æ•°å›`scoreMap.set`ãŒå‘¼ã°ã‚Œã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•**: ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã§å‘¼ã³å‡ºã—å…ƒã‚’ç¢ºèª

**å¯¾å‡¦**:
- CSVå†…ã«é‡è¤‡è¡ŒãŒãªã„ã‹ç¢ºèª
- è¤‡æ•°å›èª­ã¿è¾¼ã¿ã—ã¦ã„ãªã„ã‹ç¢ºèª

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### æ‰‹é †

1. https://smilestep-code.github.io/assessment-app/
2. **Ctrl+Shift+R** ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
3. **F12** â†’ Console ã‚¿ãƒ–
4. CSVèª­è¾¼ï¼ˆã€Œè·æ¥­ç”Ÿæ´»ã€ã€Œæ¬ å¸­ç­‰ã®é€£çµ¡ã€ã‚¹ã‚³ã‚¢5ã‚’å«ã‚€ï¼‰
5. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ä»¥ä¸‹ã‚’ç¢ºèª:

### ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

#### ãƒã‚¤ãƒ³ãƒˆ1: scoreMap.set TRACEã®å‡ºç¾

```
=== scoreMap.set TRACE START ===
```

ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

#### ãƒã‚¤ãƒ³ãƒˆ2: valueã®å€¤

```
value: 5 type: number
```

5ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

#### ãƒã‚¤ãƒ³ãƒˆ3: ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹

```
STACK TRACE
    at scoreMap.set (assessment.js:890)
    at assessment.js:945  â† ã“ã®è¡Œç•ªå·ã‚’ç¢ºèª
```

å‘¼ã³å‡ºã—å…ƒã®è¡Œç•ªå·ã‚’ç¢ºèª

#### ãƒã‚¤ãƒ³ãƒˆ4: æœ€çµ‚ç¢ºèª

```
scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
```

5ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ğŸ“Š ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®èª­ã¿æ–¹

### æ­£å¸¸ãªä¾‹

```
STACK TRACE
    at scoreMap.set (assessment.js:890)        â† ãƒ•ãƒƒã‚¯é–¢æ•°
    at assessment.js:945                       â† scoreMap.set(key, score); ã®è¡Œ
    at Array.forEach (<anonymous>)             â† dataRows.forEach ã®å†…éƒ¨
    at FileReader.reader.onload (assessment.js:892)  â† CSVèª­ã¿è¾¼ã¿å‡¦ç†
```

**è§£èª¬**:
- 1è¡Œç›®: ãƒ•ãƒƒã‚¯é–¢æ•°å†…
- 2è¡Œç›®: å®Ÿéš›ã«`scoreMap.set(key, score)`ãŒå‘¼ã°ã‚ŒãŸè¡Œï¼ˆã“ã“ã‚’ç¢ºèªï¼‰
- 3è¡Œç›®: `dataRows.forEach`ã®å†…éƒ¨
- 4è¡Œç›®: `FileReader.onload`ã®å†…éƒ¨

### 2è¡Œç›®ã®è¡Œç•ªå·ã‹ã‚‰åŸå› ã‚’ç‰¹å®š

```javascript
// assessment.js:945 ã®å†…å®¹ã‚’ç¢ºèª
scoreMap.set(key, score);  // â† ã“ã®è¡Œ

// ã“ã®ç›´å‰ã®scoreç®—å‡ºã‚’ç¢ºèª
const scoreRaw = row[colMap['ã‚¹ã‚³ã‚¢']];  // â† ã“ã“ãŒæ­£ã—ã„ã‹ï¼Ÿ
const score = normalizeNumber(scoreRaw);  // â† ã“ã“ãŒæ­£ã—ã„ã‹ï¼Ÿ
```

---

## ğŸ“ å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

1. **js/assessment.js**
   - scoreMapä½œæˆç›´å¾Œã«`scoreMap.set`ã‚’ãƒ•ãƒƒã‚¯
   - å¯¾è±¡ã‚­ãƒ¼ã®å ´åˆã€å€¤ã¨ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ãƒ­ã‚°å‡ºåŠ›

2. **index.html**
   - ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°: `?v=202602180140` â†’ `?v=202602180150`

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±

- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 202602180150
- **å¤‰æ›´å†…å®¹**: scoreMap.setãƒ•ãƒƒã‚¯å®Ÿè£…
- **ã‚³ãƒŸãƒƒãƒˆ**: ï¼ˆæ¬¡ã®ã‚³ãƒŸãƒƒãƒˆã§ç¢ºå®šï¼‰
- **GitHub Pages**: https://smilestep-code.github.io/assessment-app/

---

## ğŸ’¡ é‡è¦ãƒã‚¤ãƒ³ãƒˆ

### 1. 100%æ•æ‰

`scoreMap.set`ã‚’ãƒ•ãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ã€ã©ã“ã‹ã‚‰å‘¼ã°ã‚Œã¦ã‚‚å¿…ãšãƒ­ã‚°ãŒå‡ºã‚‹ã€‚

### 2. ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹

`console.trace()`ã«ã‚ˆã‚Šã€å‘¼ã³å‡ºã—å…ƒã®è¡Œç•ªå·ãŒæ˜ç¢ºã«ã‚ã‹ã‚‹ã€‚

### 3. å€¤ã®ç¢ºèª

`value`ãŒ5ãªã®ã‹4ãªã®ã‹ã€å‹ã¯ä½•ã‹ãŒæ˜ç¢ºã«ã‚ã‹ã‚‹ã€‚

### 4. åŸå› ã®ç‰¹å®š

ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®è¡Œç•ªå·ã‹ã‚‰ã€å•é¡Œã®ã‚³ãƒ¼ãƒ‰ã‚’ç›´æ¥ç‰¹å®šã§ãã‚‹ã€‚

---

## ğŸ“‹ æƒ³å®šã•ã‚Œã‚‹çµæœ

### æˆåŠŸæ™‚

```
=== scoreMap.set TRACE START ===
value: 5 type: number
=== scoreMap.set TRACE END ===

âœ… scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 5
ğŸ‰ğŸ‰ğŸ‰ é”æˆæ¡ä»¶ã‚¯ãƒªã‚¢
```

### å¤±æ•—æ™‚ï¼ˆå€¤ãŒ4ï¼‰

```
=== scoreMap.set TRACE START ===
value: 4 type: number
STACK TRACE
    at assessment.js:945  â† ã“ã®è¡Œã‚’ä¿®æ­£
=== scoreMap.set TRACE END ===

âŒ scoreMap.get("è·æ¥­ç”Ÿæ´»__æ¬ å¸­ç­‰ã®é€£çµ¡") = 4
```

â†’ assessment.js:945è¡Œç›®ã®ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¿®æ­£

---

**ä½œæˆæ—¥**: 2026-02-18  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 202602180150  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»ãƒ†ã‚¹ãƒˆå¾…ã¡

---

**é‡è¦**: å¿…ãš **Ctrl+Shift+R** ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰ç¢ºèªã—ã¦ãã ã•ã„ï¼

`scoreMap.set TRACE`ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã€ã‚­ãƒ¼ã®æ­£è¦åŒ–ã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
`value`ãŒ5ã§ãªã„å ´åˆã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®è¡Œç•ªå·ã‹ã‚‰åŸå› ã‚’ç‰¹å®šã—ã¦ãã ã•ã„ã€‚
